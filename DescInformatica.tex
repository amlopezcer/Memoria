\chapter{Descripción informática}

% ----------------------------
% -- Modelo de casos de uso --
% ----------------------------

\section{Especificación de Requisitos Software}

\subsection{Introducción}

\subsubsection{Propósito}

El propósito de esta sección es el de presentar los requisitos de la aplicación acorde al estándar \emph{IEEE Std. 830-1998: Especificación de Requisitos Software} (ERS en adelante), mostrando y esquematizando la funcionalidad básica del software a desarrollar.

El documento va principalmente dirigido a futuros usuarios y desarrolladores de la aplicación, de modo que cuenten con una aproximación teórica a la misma y a sus posibilidades.

\subsubsection{Ámbito del Sistema}

El futuro sistema, de nombre \emph{Bikesmanager}, consistirá en una aplicación Android encargada de la gestión de parques públicos de bicicletas a través de usuarios previamente registrados. 

Se buscará desarrollar una aplicación intuitiva y fácil de usar que cubra las necesidades de manera eficiente y eficaz, proporcionando una adecuada experiencia al usuario final.

\subsubsection{Definiciones, Acrónimos y Abreviaturas}

\begin{itemize}
	\item ERS: Especificación de Requisitos Software.
	\item Bikesmanager: Nombre de la aplicación a desarrollar.
	\item Android: Sistema operativo diseñado principalmente para dispositivos móviles con pantalla táctil.
	\item Usuario: Persona que hará uso de la aplicación.
	\item RF: Requerimiento Funcional.
	\item RNF: Requerimineto No Funcional.
\end{itemize}

\subsubsection{Referencias}

\begin{itemize}
	\item IEEE Std. 830-1998: Especificaciones de los Requisitos del Software
\end{itemize}

\subsubsection{Visión General del Documento}

Una vez realizada la introducción general previa, se aportará a continuación una primera descripción general del sistema a desarrollar para, finalmente, pasar a detallar los requisitos específicos básicos del mismo.

En el apartado dedicado a la descripción general se aporta una visión global de la aplicación, así como de las funciones básicas de la misma. Funciones que se detallan en la sección siguiente, junto con otros aspectos como los atributos del sistema sobre los que se implantará el desarrollo.

\subsection{Descripción General}

\subsubsection{Perspectiva del Producto}

La aplicación \emph{Bikesmanager} será un producto diseñado para trabajar sobre dispositivos móviles con sistema operativo Android, donde los datos quedarán almacenados en una base de datos a la que se accederá mediante el servidor de la aplicación. La conexión de la herramienta con el servidor se realizará mediante servicios web.

\subsubsection{Funciones del Producto}

En la figura ~\ref{fig:diagramaCasosUso} se aporta el diagrama de casos de uso que muestra, a grandes rasgos, las funciones del futuro sistema.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/01_CasosDeUso}
	\caption{Diagrama de casos de uso}
	\label{fig:diagramaCasosUso}
\end{figure}


\FloatBarrier % Evita que figuras de secciones previas se cuelen por aquí
\subsubsection{Características de los Usuarios}

\begin{itemize}
	\item Tipo de usuario: Usuario
	\begin{itemize}
		\item Nivel educacional: irrelevante.
		\item Experiencia técnica: experiencia en el manejo de \textit{smartphones}.
		\item Actividad: manejo de la aplicación.
	\end{itemize}
\end{itemize}

\subsubsection{Restricciones}

\begin{itemize}	
	\item Limitaciones hardware:
	\begin{itemize}
		\item Los servidores han de ser capaces de atender consultas concurrentes.
		\item Los dispositivos móviles deberán estar gestionados por el sistema operativo Android.
	\end{itemize}
	\item Arquitectura del sistema: cliente/servidor de tres capas, con servidor de aplicación Glassfish y SQL Server de base de datos.
	\item Lenguaje(s) en uso: JAVA, SQL.
	\item Protocolos de comunicación: 
	\begin{itemize}
		\item Aplicación -- Servidor: HTTP (RESTful Web Services - JSON).
		\item Servidor Aplicación -- Base de Datos: MySQL Connector/JDBC.
	\end{itemize}
	\item Consideraciones acerca de la seguridad:
	\begin{itemize}
		\item El acceso a la aplicación se realizará mediante el par usuario-contraseña.
		\item Las claves de usuario deberán almacenarse de manera segura mediante encriptación SHA-1.
		\item Desde la aplicación ningún usuario tendrá acceso a la administración interna de la misma, sino que dicha tarea se realizará directamente sobre el servidor o base de datos.
	\end{itemize}
\end{itemize}

\subsubsection{Suposiciones y Dependencias}

\begin{itemize}	
	\item Se asume que los requisitos aquí descritos son estables.
	\item Los equipos en los que se vaya a ejecutar el sistema deben cumplir los requisitos antes indicados para garantizar el adecuado funcionamiento de la aplicación.
\end{itemize}

\subsubsection{Requisitos Futuros}

No se consideran requisitos futuros.

\subsection{Requisitos Específicos}

\subsubsection{Interfaces Externas}

La interfaz con el usuario consistirá en un conjunto de pantallas con los controles habituales: botones, campos de texto, listas, etc. sobre la que se deberá asegurar una adecuada experiencia de usuario mediante diseños que sigan las normas Android \footnote{\url{https://developer.android.com/guide/practices/ui_guidelines/index.html}}. Esta interfaz deberá ser construida para el sistema especificado y será visualizada mediante dispositivos móviles. Del mismo modo, destacar que el diseño de la interfaz gráfica de usuario deberá fundamentarse en los llamados \emph{fragments} de Android, de modo que el mismo pueda ser reutilizable y fácilmente transportable a otras dimensiones u orientaciones de pantalla.

En relación a las interfaces hardware-software, se deberá contar con un dispositivo móvil con conexión a internet y que implemente, como mínimo, la versión 4.0 del sistema Android (llamada \emph{Ice Cream Sandwich}\footnote{Android denomina alfabéticamente y con nombres de dulces a cada una de las versiones de su sistema operativo. En el momento de la redacción de este documento, la versión más actualizada es la 7.0, \textit{Nougat}.}).

Finalmente, acerca de las interfaces de comunicación, la aplicación se comunicará con su servidor mediante el protocolo HTTP haciendo uso de RESTful Web Services y cadenas JSON. La conexión entre el servidor de aplicación y la base de datos se realizará mediante las tecnologías MySQL Connector/JDBC.
\subsubsection{Funciones}

En esta sección se desarrolla la descripción de los diferentes requerimientos funcionales y no funcionales con que deberá contar el sistema. 

Se comienza por los \emph{Requerimientos Funcionales}, para los que se aporta su definición acompañada de una descripción textual y del diagrama de actividad correspondiente, de modo que cada requerimiento quede adecuadamente descrito.

\begin{itemize}
	\item \textbf{RF01: Registrar usuario}. El sistema deberá permitir el registro de nuevos usuarios. Para ello, se solicitarán el nombre usuario, contraseña, dirección de correo electrónico y nombre y apellidos reales. El nombre de usuario y la dirección de correo han de ser únicos, de modo que no se permita la duplicidad de los mismos en la aplicación. Asimismo, la contraseña ha de ser encriptada a la hora de ser almacenada en la base de datos.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF01: Registrar usuario}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			1. Seleccionar registro &\\ \hline
			& 2. Mostrar interfaz \\ \hline
			3. Introducir datos &\\ \hline
			& 4. Comprobar datos obligatorios \\ \hline
			& 5. Validar campos únicos\\ \hline
			& 6. Crear registro \\ \hline
		\end{tabular}
		\caption{Descripción textual de RF01: Registrar usuario}
		\label{tab:tablaDescTextualRF01}
	\end{table}
	
	\FloatBarrier
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{12cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF01_registrarUsuario}}
		\caption{Diagrama de actividad de RF01: Registrar usuario}
		\label{fig:diagramaActividad_RF01}
	\end{figure}
	 
	\item \textbf{RF02: Loguear usuario}. El sistema deberá permitir la autenticación de usuarios para su acceso. Este proceso se realizará mediante el par usuario-contraseña. Señalar que, como se ha especificado en el requisito previo, la contraseña se almacena encriptada, de modo que la introducida por el usuario que trata de acceder ha de ser tratada por el mismo algortimo para poder realizar la comparación.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF02: Loguear usuario}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			1. Seleccionar login &\\ \hline
			& 2. Mostrar interfaz \\ \hline
			3. Introducir datos &\\ \hline
			& 4. Comprobar campos obligatorios \\ \hline
			& 5. Autenticar \\ \hline
			& 6. Completar login\\ \hline
		\end{tabular}
		\caption{Descripción textual de RF02: Loguear usuario}
		\label{tab:tablaDescTextualRF02}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{9cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF02_loguear}}
		\caption{Diagrama de actividad de RF02: Loguear usuario}
		\label{fig:diagramaActividad_RF02}
	\end{figure}

	\FloatBarrier
	\item \textbf{RF03: Modificar perfil}. El sistema deberá permitir la modificación del perfil de usuario solicitados en el proceso de registro, considerando que el nombre de usuario y dirección de correo han de ser únicos.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF03: Modificar perfil}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar modificar perfil &\\ \hline
			& 2. Mostrar interfaz\\ \hline
			3. Introducir datos &\\ \hline
			& 4. Validar campos únicos\\ \hline
			& 5. Solicitar confirmación\\ \hline
			6. Confirmar operación &\\ \hline
			& 7. Actualizar registro \\ \hline
			& 8. Confirmar operación terminada \\ \hline 
		\end{tabular}
		\caption{Descripción textual de RF03: Modificar perfil}
		\label{tab:tablaDescTextualRF03}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{8cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF03_modificarPerfil}}
		\caption{Diagrama de actividad de RF03: Modificar perfil}
		\label{fig:diagramaActividad_RF03}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF04: Borrar perfil}. El sistema deberá permitir el borrado completo de perfiles. Este proceso requerirá de una confirmación explícita por parte del usuario y, en el momento en que se realice, será irreversible, borrando el registro específico de la base de datos. El dinero ingresado será devuelto y las posibles reservas, canceladas.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF04: Borrar perfil}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar borrar perfil &\\ \hline
			& 2. Solicitar confirmación\\ \hline
			3. Confirmar operación &\\ \hline
			& 4. Devolver saldo y eliminar posibles reservas \\ \hline
			& 5. Borrar registro \\ \hline
		\end{tabular}
		\caption{Descripción textual de RF04: Borrar perfil}
		\label{tab:tablaDescTextualRF04}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{9cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF04_borrarPerfil}}
		\caption{Diagrama de actividad de RF04: Borrar perfil}
		\label{fig:diagramaActividad_RF04}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF05: Ingresar saldo}. El sistema deberá permitir el ingreso de dinero, de modo que el usuario cuente con saldo suficiente para que pueda operar con el parque de bicicletas.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF05: Ingresar saldo}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar ingreso &\\ \hline
			& 2. Mostrar interfaz \\ \hline
			3. Introducir datos &\\ \hline
			& 4. Actualizar registro \\ \hline
			& 5. Confirmar operación terminada \\ \hline 	
		\end{tabular}
		\caption{Descripción textual de RF05: Ingresar saldo}
		\label{tab:tablaDescTextualRF05}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{10.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF05_ingresarSaldo}}
		\caption{Diagrama de actividad de RF05: Ingresar saldo}
		\label{fig:diagramaActividad_RF05}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF06: Coger bicicleta}. El sistema deberá permitir coger bicicletas a los usuarios registrados y logueados en el sistema. Se han tener en cuenta las siguientes restricciones:
	\begin{itemize}
		\item El usuario sólo puede tener una bicicleta cogida a la vez.
		\item El usuario ha de disponer de saldo suficiente para completar la operación.
		\item En caso de haber reservado previamente, el usuario sólo podrá coger la bicicleta de la estación en la que haya realizado dicha reserva.
		\item Las bicicletas reservadas por otros usuarios no están disponibles.
	\end{itemize}
	Señalar, a su vez, que la estación deberá mostrar una tarifa adaptada a la disponibilidad de bicicletas. Es decir, partiendo de una tarifa base, ésta se verá acrecentada a medida que las bicis disponibles se vean reducidas. 
	
	El objetivo es introducir un primer nivel de adaptación a las condiciones del entorno, de modo que los usuarios tengan alicientes para coger bicicletas de estaciones con una mayor disponibilidad. 
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF06: Coger bicicleta}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar estación &\\ \hline
			& 2. [RF11: Actualizar] \\ \hline
			3. Seleccionar coger bici &\\ \hline
			& 4. Comprobar restricciones \\ \hline
			& 5. [RF10: Pagar] \\ \hline
			& 6. Actualizar estado global \\ \hline
			& 7. Confirmar operación terminada \\ \hline 	
		\end{tabular}
		\caption{Descripción textual de RF06: Coger bicicleta}
		\label{tab:tablaDescTextualRF06}
	\end{table}
	
	\FloatBarrier
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{13.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF06_cogerBicicleta}}
		\caption{Diagrama de actividad de RF06: Coger bicicleta}
		\label{fig:diagramaActividad_RF06}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF07: Dejar bicicleta}. El sistema deberá permitir dejar, en estaciones con disponibilidad suficiente, bicicletas previamente cogidas por usuarios. Se han tener en cuenta las siguientes restricciones:
	\begin{itemize}
		\item En caso de haber reservado un anclaje previamente, el usuario sólo podrá dejar la bicicleta en la estación en la que haya realizado dicha reserva.
		\item Los anclajes reservados por otros usuarios no están disponibles
	\end{itemize}
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF07: Dejar bicicleta}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar estación &\\ \hline
			& 2. [RF11: Actualizar] \\ \hline
			3. Seleccionar dejar bici &\\ \hline
			& 4. Comprobar restricciones \\ \hline
			& 5. Actualizar estado global \\ \hline
			& 6. Confirmar operación terminada \\ \hline 
		\end{tabular}
		\caption{Descripción textual de RF07: Dejar bicicleta}
		\label{tab:tablaDescTextualRF07}
	\end{table}
	
	\FloatBarrier
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{13.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF07_dejarBicicleta}}
		\caption{Diagrama de actividad de RF07: Dejar bicicleta}
		\label{fig:diagramaActividad_RF07}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF08: Reservar}. El sistema deberá permitir la reserva de recursos, que podrán ser de dos tipos: bicicletas o anclajes. Se han tener en cuenta las siguientes restricciones:
	\begin{itemize}
		\item El usuario sólo puede tener una reserva de cada tipo a la vez. Es decir, se permiten tener, como mucho, dos reservas simultáneas por usuario: una bicicleta y un anclaje.
		\item En caso de tener una bicicleta cogida, el usuario no podrá realizar la reserva de otra.
	\end{itemize}
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF08: Reservar}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar estación &\\ \hline
			& 2. [RF11: Actualizar] \\ \hline
			3. Seleccionar reservar &\\ \hline
			& 4. Mostrar opciones de reserva \\ \hline
			5. Seleccionar tipo de reserva &\\ \hline
			& 6. Comprobar restricciones \\ \hline
			& 7. Actualizar estado global \\ \hline
			& 8. Confirmar operación terminada \\ \hline 
		\end{tabular}
		\caption{Descripción textual de RF08: Reservar}
		\label{tab:tablaDescTextualRF08}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{12cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF08_reservar}}
		\caption{Diagrama de actividad de RF08: Reservar}
		\label{fig:diagramaActividad_RF08}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF09: Cancelar reserva}. El sistema deberá permitir la cancelación de reservas, tanto de bicicletas como de anclajes. Esta cancelación se podrá realizar por las siguientes vías:
	\begin{itemize}
		\item Cancelación explícita por parte del usuario. Este tipo de cancelación implica una confirmación por parte del usuario.
		\item Cancelación implícita al cabo de 30 minutos del momento de la reserva.
	\end{itemize}
	Si un usuario ejerce su derecho sobre una reserva, la misma queda automáticamente cancelada.
	
	Se aporta la descripción textual del requisito referido a la cancelación explícita, puesto que es la única en la que interviene el usuario de manera directa:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF09: Cancelar reserva (explícita)}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF08: Reservar] &\\ \hline
			1. Seleccionar cancelar reserva &\\ \hline
			& 2. Solicitar confirmación \\ \hline
			3. Confirmar operación &\\ \hline
			& 4. Actualizar estado global \\ \hline
			& 5. Confirmar operación terminada \\ \hline 	
		\end{tabular}
		\caption{Descripción textual de RF09: Cancelar reserva (explícita)}
		\label{tab:tablaDescTextualRF09}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{11cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF09_cancelarReserva}}
		\caption{Diagrama de actividad de RF09: Cancelar reserva (explícita)}
		\label{fig:diagramaActividad_RF09}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF10: Pagar}. El sistema deberá permitir realizar el pago de las operaciones desarrolladas por los usuarios.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF10:Pagar}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF06: Coger bicicleta] &\\ \hline
			& 1. Solicitar confirmación \\ \hline
			2. Confirmar operación &\\ \hline
			& 3. Realizar pago \\ \hline
			& 4. Actualizar usuario \\ \hline 
			& 5. Confirmar operación terminada \\ \hline 	
		\end{tabular}
		\caption{Descripción textual de RF10: Pagar}
		\label{tab:tablaDescTextualRF10}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{11cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF10_pagar}}
		\caption{Diagrama de actividad de RF10: Pagar}
		\label{fig:diagramaActividad_RF10}
	\end{figure}
	
	\item \textbf{RF11: Actualizar}. El sistema deberá permitir actualizar el estado global tomando la información más reciente almacenada en el servidor. En este sentido, con cada solicitud de actualización, en el proceso se deberá comprobar si existen reservas caducadas, cancelándolas automáticamente de modo que se ofrezca al usuario una visión consistente de la disponibilidad del parque de bicicletas.
	
	La descripción textual:
	\begin{table}[h]
		\centering	
		\begin{tabular}{|l|l|}
			\hline
			\multicolumn{2}{|c|}{\textbf{RF11:Actualizar}} \\ \hline
			\multicolumn{1}{|c|}{\textbf{Usuario}} & \multicolumn{1}{c|}{\textbf{Sistema}} \\ \hline
			[Pto. inclusión: RF02: Loguear usuario] &\\ \hline
			1. Seleccionar actualizar &\\ \hline
			& 2. Actualizar estado\\ \hline
			& 3. Mostrar estado actualizado \\ \hline 	
		\end{tabular}
		\caption{Descripción textual de RF11: Actualizar}
		\label{tab:tablaDescTextualRF11}
	\end{table}
	
	Y el diagrama de actividad:
	\begin{figure}[!htb]
		\centering
		\resizebox{13cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/02_Actividad_RF11_actualizar}}
		\caption{Diagrama de actividad de RF11: Actualizar}
		\label{fig:diagramaActividad_RF11}
	\end{figure}

\end{itemize}

Finalmente, se pasan a detallar los \emph{Requerimientos No Funcionales} más relevantes:

\begin{itemize}
	\item \textbf{RNF01: Usabilidad}. El sistema ha de presentar una interfaz sencilla e intuitiva, respetando las normas de diseño Android y proporcionando una adecuada retroalimentación al usuario de las operaciones terminadas y de posibles errores en su manejo.
	
	\item \textbf{RNF02: Eficiencia}. El sistema ha de trasladar toda operación posible a la capa de servidor, de modo que el cliente suponga la menor carga posible para el dispositivo móvil y se reduzcan los tiempos de espera.

	
	\item \textbf{RNF03: Seguridad}. El sistema ha de asegurar la seguridad en el tratamiento de la información del usuario. 
	
	El detalle de este RNF se recoge en el apartado posterior referido a los Atributos del Sistema
	
	\item \textbf{RNF04: Fiabilidad}. El sistema ha operar según lo esperado y minimizando en la medida de los posible la probabilidad de aparición de fallos. E
	
	El detalle de este RNF se recoge en el apartado posterior referido a los Atributos del Sistema
	
	\item \textbf{RNF05: Mantenibilidad}. El sistema se ha de desarrollar de modo que pueda ser conservado y restituido (en caso necesario) con facilidad.
	
	El detalle de este RNF se recoge en el apartado posterior referido a los Atributos del Sistema
	
	\item \textbf{RNF06: Portabilidad}. El sistema ha de desarrollarse de modo que pueda ser ejecutado en diferentes plataformas. 
	
	El detalle de este RNF se recoge en el apartado posterior referido a los Atributos del Sistema
	
	\item \textbf{RNF07: Disponibilidad}. El sistema ha de permanecer en funcionamiento continuo para prestar una servicio adecuado a los usuarios.
	
	El detalle de este RNF se recoge en el apartado posterior referido a los Atributos del Sistema
	
\end{itemize}

\subsubsection{Requisitos de Rendimiento}

Desde el punto de vista de la aplicación móvil, no se espera una carga excesiva en el dispositivo por gestionar únicamente los datos del usuario registrado.

El servidor, por su parte, ha de ser capaz de dar respuesta a una serie de peticiones concurrentes que pueden escalar a la cantidad de dispositivos que tengan instalada la aplicación.

Finalmente, en relación a la cantidad de registros almacenados en la base de datos, se espera que queden registrados de manera individual tanto usuarios como puestos de bicicletas, además de posibles tablas adicionales.

\subsubsection{Restricciones de Diseño}

Para el diseño de la aplicación se deberán utilizar componentes compatibles con la versión 4.0 de Android, en caso de no estar disponibles, se deberá recurrir a librerías de soporte para dar servicio a dicha versión, cumpliendo con ella, las restricciones hardware quedan, a su vez, cubiertas.

En relación al servidor de aplicación, éste ha de ser capaz de gestionar accesos concurrentes a recursos compartidos, controlando las posibles condiciones de carrera que puedan aparecer y dando un respuesta oportuna al usuario. 

\subsubsection{Atributos del Sistema}

\begin{itemize}
	\item Seguridad.
	\begin{itemize}
		\item El acceso a la aplicación se realizará mediante el par usuario-contraseña.
		\item Las claves de usuario deberán almacenarse de manera segura mediante encriptación SHA-1.
		\item Desde la aplicación ningún usuario tendrá acceso a la administración interna de la misma, sino que dicha tarea se realizará directamente sobre el servidor o base de datos donde sólo el desarrollador o mantendor de la aplicación podrá acceder.
	\end{itemize}
	\item Fiabilidad.
	\begin{itemize}
		\item El sistema ha de quedar adecuadamente testeado previa distribución para obtener una adecuada cobertura de fallos.
		\item La interfaz de usuario ha de ser sencilla e intuitiva y, en caso de ser necesario, deberá informar con el resultado de las operaciones para una adecuada experiencia en su uso.
	\end{itemize}
	\item Mantenibilidad.
	\begin{itemize}
		\item La aplicación ha de quedar desarrollada siguiendo las buenas prácticas del desarrollo software (código adecuadamente organizado y comentado, utilización de patrones de diseño estandarizados, utilización de \textit{idioms}, etc.).
		\item La herramienta deberá dejar \textit{logs} internos de las áreas que se consideren más relevantes o susceptibles a fallos de modo que puedan ser consultados por los desarrolladores para realizar tareas de depuración.
	\end{itemize}
	\item Portabilidad. 
	\begin{itemize}
		\item La aplicación podrá ser instalada en cualquier dispositivo con sistema operativo Android (versión mínima 4.0).
		\item Los servidores de aplicación y base de datos se podrán desplegar sobre cualquiera de los sistemas operativos más extendidos (Windows, Linux, iOS, etc.).
		\item Queda como tarea futura la adaptación de la aplicación móvil a entornos web e iOS.
	\end{itemize}
	\item Disponibilidad. 
	\begin{itemize}
		\item Los servidores han de estar operativos 24x7 para atender las necesidades de uso.
	\end{itemize}
\end{itemize}

\subsubsection{Otros Requisitos}

No se consideran otros requisitos de los especificados en secciones previas.


% ------------------------
% -- Modelo de analisis --
% ------------------------

\section{Análisis}
\label{sec:secModeloAn}

\subsection{Introducción}

El análisis de los requerimientos descritos ha de dar como resultado la especificación de las características operativas del software, indicando la interfaz de éste y otros elementos del sistema, y estableciendo las restricciones que limitan al software.

Este proceso de análisis otorga la información que se traduce en diseños de arquitectura, interfaz y componentes, así como los medios para evaluar la calidad del software una vez construido. 

Por lo tanto, el modelo de análisis supone un puente entre la descripción del sistema y su diseño posterior. Esta relación queda esquematizada en la figura ~\ref{fig:modeloAnalisis}.

\begin{figure}
	\centering
	\resizebox{8cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/ModeloAnalisis}}
	\caption{El modelo de análisis como puente entre los requerimientos y el diseño del software, de Pressman 2010}
	\label{fig:modeloAnalisis}
\end{figure}

Este modelo se desarrollará en dos pasos: 

\begin{enumerate}  
	\item \textbf{Análisis conceptual del sistema}. Se presentará la vista estática general del sistema mediante un diagrama de clases de análisis. El objetivo es el de obtener una perspectiva global y con un alto nivel de abstracción del software y sus entidades básicas.
	\item \textbf{Análisis y desarrollo de requisitos}. Los requisitos descritos en la sección anterior se comenzarán a desarrollar mediante diagramas de colaboración (o comunicación), de modo que se tenga una primera visión de la futura implementación de cada uno y se muestre una primera aproximación a la interacción entre entidades.
\end{enumerate}

Cabe señalar que, en este punto, la atención se centra en el \emph{qué}, no en el \emph{cómo}, con lo no se entrará en detalles técnicos, de diseño o de implementación.

\subsection{Análisis conceptual del sistema}

Para el análisis y representación del modelo conceptual de datos se recurrirá diagrama de clases de análisis, que de lugar a la vista estática general del sistema e identifique sus entidades básicas usando la terminología del dominio aplicable. Si bien se cuenta con un cierto grado de subjetividad, las clases potenciales a incluir en este punto deberán cubrir todos (o casi todos) los puntos siguientes \cite{Coa91}:

\begin{enumerate}  
	\item \textit{Información retenida}. Debe recordarse la información sobre la clase para que el sistema pueda funcionar.
	\item \textit{Servicios necesarios}. La clase potencial debe tener un conjunto de operaciones identificables que cambien en cierta manera el valor de sus atributos.
	\item \textit{Atributos múltiples}. Centrando la atención en la información “principal”;
	\item \textit{Atributos comunes}. Para la clase potencial se define un conjunto de atributos y se aplican éstos a todas las instancias de la clase.
	\item \textit{Operaciones comunes}. Se define un conjunto de operaciones para la clase potencial y éstas se aplican a todas las instancias de la clase.
	\item \textit{Requerimientos esenciales}. Las entidades externas que aparezcan en el espacio del problema y que produzcan o consuman información esencial para la operación de cualquier solución para el sistema casi siempre se definirán como clases en el modelo de requerimientos.	
\end{enumerate}

Con todo, quedan identificadas las siguientes entidades básicas:

\begin{itemize}
	\item \textbf{Gestor Conexión Remota}. Desde el momento en el que la aplicación contará con una arquitectura cliente/servidor y la comunicación entre ambas entidades se realizará de manera remota, se requiere de una entidad que gestione dicha comunicación y sepa dar respuesta a las operaciones CRUD\footnote{Siglas en inglés de las operaciones básicas para la gestión de datos: Create, Read, Update y Delete}.
	\item \textbf{Entidad Remota}. La entidad que quedará gestionada por la clase anterior, supone la generalización de alguna de las siguientes entidades:
	\begin{itemize}
		\item \textbf{Usuario}. Se deberán recoger los atributos básicos para poder realizar el login, como el nombre de usuario y contraseña, datos personales, como el nombre y apellidos, y datos operativos, como el saldo o datos acerca de si se tiene una reserva o bicicleta. Del mismo modo, el usuario deberá ser capaz de interactuar con las estaciones de bicicletas, cogiendo y dejando las mismas o gestionando reservas.
		\item \textbf{Estación}. La estación de bicicletas, deberá contar con datos identificativos, como la dirección donde se encuentre ubicada, y con datos operativos referidos al total de bicicletas o anclajes disponibles, reservados, etc., así como la tarifa base de esa estación. La estación deberá poder gestionar las operaciones comenzadas por los usuarios y mostrar su estado convenientemente actualizado.
		\item \textbf{Reserva}. Se considera relevante contar con una clase para almacenar las reservas de usuarios, de modo que su gestión global sea más sencilla. Esta entidad deberá contar con los datos de la reserva (tipo (anclaje o bicicleta), nombre de usuario, fecha y estación) y con la constante que defina el tiempo máximo por reserva (30 minutos, de acuerdo a los requisitos).
	\end{itemize}
\end{itemize}

De este modo, el \emph{Gestor de Conexión Remota} será el encargado de enviar y recibir datos para las entidades, sin necesidad de diferenciar entre ninguna de ellas por atender directamente la general \emph{Entidad Remota}.

Este conjunto de entidades básicas, junto con sus potenciales atributos y operaciones básicas, queda modelizado en la figura ~\ref{fig:diagramaClasesAnalisis}.

\begin{figure}
	\centering
	\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/03_ClasesAnalisis}
	\caption{Diagrama de clases de análisis}
	\label{fig:diagramaClasesAnalisis}
\end{figure}

\subsection{Análisis y desarrollo de requisitos}

Con la vista estática del futuro sistema presentada, a continuación se pasa a describir las realizaciones más relevantes de cada caso de uso presentados en la figura ~\ref{fig:diagramaCasosUso}. Esto es, por cada requisito funcional se modelizará la realización de su camino principal y caminos alternativos de relevancia obtenidos a partir de los diagramas de actividad anteriores.

El objetivo es el de componer un análisis adecuado de las posibles operaciones e interacciones que cada requisito puede desencadenar y las entidades afectadas ante los caminos de ejecución más probables.

\begin{itemize}
	\item \textbf{RF01: Registrar usuario}. Tres caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación de registro finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF01_1}
		\item Camino alternativo 1, el usuario no introduce todos los datos obligatorios. Ver figura ~\ref{fig:diagramaColaboracion_RF01_2}
		\item Camino alternativo 2, se aportan todos los datos requeridos, pero el nombre de usuario o dirección de correo electrónico ya están en uso. Ver figura ~\ref{fig:diagramaColaboracion_RF01_3}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{13.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF01_1}}
		\caption{Diagrama de colaboración del camino principal del RF01}
		\label{fig:diagramaColaboracion_RF01_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{13.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF01_2}}
		\caption{Diagrama de colaboración del primer camino alternativo del RF01}
		\label{fig:diagramaColaboracion_RF01_2}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{13.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF01_3}}
		\caption{Diagrama de colaboración del segundo camino alternativo del RF01}
		\label{fig:diagramaColaboracion_RF01_3}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF02: Loguear usuario}. Tres caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación de inicio de sesión finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF02_1}
		\item Camino alternativo 1, el usuario no introduce todos los datos obligatorios. Ver figura ~\ref{fig:diagramaColaboracion_RF02_2}
		\item Camino alternativo 2, autenticación incorrecta, se aportan todos los datos requeridos, pero el nombre de usuario y/o contraseña no son correctos. Ver figura ~\ref{fig:diagramaColaboracion_RF02_3}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF02_1}
		\caption{Diagrama de colaboración del camino principal del RF02}
		\label{fig:diagramaColaboracion_RF02_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF02_2}
		\caption{Diagrama de colaboración del primer camino alternativo del RF02}
		\label{fig:diagramaColaboracion_RF02_2}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF02_3}
		\caption{Diagrama de colaboración del segundo camino alternativo del RF02}
		\label{fig:diagramaColaboracion_RF02_3}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF03: Modificar perfil}. Se consideran tres caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación de modificación de perfil finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF03_1}
		\item Camino alternativo 1, el nuevo nombre de usuario y/o dirección de correo electrónico ya están en uso. Ver figura ~\ref{fig:diagramaColaboracion_RF03_2}
		\item Camino alternativo 2, el usuario cancela la operación ante la confirmación final. Ver figura ~\ref{fig:diagramaColaboracion_RF03_3}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{13.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF03_1}}
		\caption{Diagrama de colaboración del camino principal del RF03}
		\label{fig:diagramaColaboracion_RF03_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF03_2}
		\caption{Diagrama de colaboración del primer camino alternativo del RF03}
		\label{fig:diagramaColaboracion_RF03_2}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF03_3}
		\caption{Diagrama de colaboración del segundo camino alternativo del RF03}
		\label{fig:diagramaColaboracion_RF03_3}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF04: Borrar perfil}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación de borrado de perfil finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF04_1}
		\item Camino alternativo 1, el usuario cancela la operación ante la confirmación final. Ver figura ~\ref{fig:diagramaColaboracion_RF04_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{12.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF04_1}}•
		\caption{Diagrama de colaboración del camino principal del RF04}
		\label{fig:diagramaColaboracion_RF04_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{12.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF04_2}}
		\caption{Diagrama de colaboración del primer camino alternativo del RF04}
		\label{fig:diagramaColaboracion_RF04_2}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF05: Ingresar saldo}. Se considera un único camino básico: el ingreso sin incidencias de saldo. Ver figura ~\ref{fig:diagramaColaboracion_RF05_1}
	\begin{figure}[!htb]
		\centering
		\resizebox{12.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF05_1}}
		\caption{Diagrama de colaboración del camino principal del RF05}
		\label{fig:diagramaColaboracion_RF05_1}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF06: Coger bicicleta}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF06_1}
		\item Camino alternativo 1, el usuario no supera alguna de las restricciones impuestas sobre la operación (mencionadas en la especificación de requisitos anterior). Ver figura ~\ref{fig:diagramaColaboracion_RF06_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{12cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF06_1}}
		\caption{Diagrama de colaboración del camino principal del RF06}
		\label{fig:diagramaColaboracion_RF06_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{12cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF06_2}}
		\caption{Diagrama de colaboración del primer camino alternativo del RF06}
		\label{fig:diagramaColaboracion_RF06_2}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF07: Dejar bicicleta}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF07_1}
		\item Camino alternativo 1, el usuario no supera alguna de las restricciones impuestas sobre la operación (mencionadas en la especificación de requisitos anterior). Ver figura ~\ref{fig:diagramaColaboracion_RF07_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{12.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF07_1}}
		\caption{Diagrama de colaboración del camino principal del RF07}
		\label{fig:diagramaColaboracion_RF07_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{12.5cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF07_2}}
		\caption{Diagrama de colaboración del primer camino alternativo del RF07}
		\label{fig:diagramaColaboracion_RF07_2}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF08: Reservar}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF08_1}
		\item Camino alternativo 1, el usuario no supera alguna de las restricciones impuestas sobre la operación (mencionadas en la especificación de requisitos anterior). Ver figura ~\ref{fig:diagramaColaboracion_RF08_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{11cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF08_1}}
		\caption{Diagrama de colaboración del camino principal del RF08}
		\label{fig:diagramaColaboracion_RF08_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{11cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF08_2}}
		\caption{Diagrama de colaboración del primer camino alternativo del RF08}
		\label{fig:diagramaColaboracion_RF08_2}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF09: Cancelar reserva}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF09_1}
		\item Camino alternativo 1, el usuario cancelar la operación ante la confirmación final. Ver figura ~\ref{fig:diagramaColaboracion_RF09_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\resizebox{14cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF09_1}}
		\caption{Diagrama de colaboración del camino principal del RF09}
		\label{fig:diagramaColaboracion_RF09_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\resizebox{14cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF09_2}}
		\caption{Diagrama de colaboración del primer camino alternativo del RF09}
		\label{fig:diagramaColaboracion_RF09_2}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF10: Pagar}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, la operación finaliza satisfactoriamente. Ver figura ~\ref{fig:diagramaColaboracion_RF10_1}
		\item Camino alternativo 1, el usuario cancelar la operación ante la confirmación final. Ver figura ~\ref{fig:diagramaColaboracion_RF10_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF10_1}
		\caption{Diagrama de colaboración del camino principal del RF10}
		\label{fig:diagramaColaboracion_RF10_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF10_2}
		\caption{Diagrama de colaboración del primer camino alternativo del RF10}
		\label{fig:diagramaColaboracion_RF10_2}
	\end{figure}
	
	\FloatBarrier
	\item \textbf{RF11: Actualizar}. Se consideran dos caminos básicos: 
	\begin{enumerate}
		\item Camino principal, en el proceso de actualización se identifican reservas caducadas, que se cancelan automáticamente. Ver figura ~\ref{fig:diagramaColaboracion_RF11_1}
		\item Camino alternativo 1, no se identifican reservas caducadas, el proceso consiste en leer datos actualizados. Ver figura ~\ref{fig:diagramaColaboracion_RF11_2}
	\end{enumerate}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF11_1}
		\caption{Diagrama de colaboración del camino principal del RF11}
		\label{fig:diagramaColaboracion_RF11_1}
	\end{figure}
	\begin{figure} [!htb]
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/04_Colaboracion_RF11_2}
		\caption{Diagrama de colaboración del primer camino alternativo del RF11}
		\label{fig:diagramaColaboracion_RF11_2}
	\end{figure}
		
\end{itemize}


% ----------------------
% -- Modelo de diseño --
% ----------------------

\section{Diseño}

\subsection{Introducción}

Sintetizando a Pressman \cite{Pre10}, el diseño del software comienza una vez que se han analizado y modelado los requerimientos (etapas centradas en describir los datos que se necesitan, la función y el comportamiento), es la última acción de la ingeniería de software dentro de la actividad de modelado y prepara la etapa de construcción (generación y prueba de código) proporcionando detalles sobre arquitectura del software, estructuras de datos, interfaces y componentes.

Así, el modelo de diseño que a continuación se desarrolla, se dividirá dos partes principales:

\begin{enumerate}
	\item \textbf{Diseño de la arquitectura}. Se presentará el diseño de la arquitectura general que adoptará el sistema y de las interrelaciones entre sus componentes. La modelización de dicha estructura se llevará a cabo mediante el diagrama de clases de diseño, dando lugar a visión más detallada del sistema a implementar.
	\item \textbf{Diseño de las interfaces}. En esta segunda parte se recogerán las decisiones de diseño más relevantes con referencia a las interfaces de usuario y comunicación de la aplicación.
\end{enumerate}

Por su parte, el diseño en el nivel de componentes y despliegue se tratará en la sección ~\ref{sec:secModeloImp} siguiente, acerca del \emph{Modelo de Implementación}.

\subsection{Diseño de la arquitectura}

La \emph{arquitectura del software} supone “la estructura o estructuras del sistema, lo que comprende a los componentes del software, sus propiedades externas visibles y las relaciones entre ellos” \cite{Bas03}.

Si bien cabe señalar que la arquitectura no es el software operativo. Es una representación que permite \cite{Pre10}: 1) analizar la efectividad del diseño para cumplir los requerimientos establecidos, 2) considerar alternativas arquitectónicas en una etapa en la que hacer cambios al diseño todavía es relativamente fácil y 3) reducir los riesgos asociados con la construcción del software.

La definición previa pone el énfasis en el papel de los “componentes del software”, que puede ser algo tan simple como un módulo de programa o una clase orientada a objeto, si bien también puede ampliarse a conceptos más extensos y complejos.

\subsubsection{Estilo arquitectónico}

Considerando los conceptos anteriores y con base en las especificación de requisitos previa, el estilo arquitectónico sobre el que se sustentará el sistema es el \emph{Cliente/Servidor} en su variación de tres capas, tal y como se muestra en la figura ~\ref{fig:arqClienteServ3Cap}:

\begin{figure}
	\centering
	\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/ArqClienteServ3Cap}
	\caption{Esquema de la arquitectura Cliente/Servidor de tres capas}
	\label{fig:arqClienteServ3Cap}
\end{figure}

\begin{enumerate}
	\item \textbf{Cliente}. Supone la capa de presentación, la Interfaz de Usuario. Su función es traducir tareas y/o resultados para resultar comprensibles por el usuario.
	\item \textbf{Servidor}. La capa lógica encargada de coordinar la aplicación y procesar datos entre el resto de capas.
	\item \textbf{Base de datos}. Implica la capa de datos, donde la información es almacenada y recuperada por parte de la capa lógica para su procesamiento.
\end{enumerate}

En la sección ~\ref{sec:secModeloImp} se entra en mayor detalle sobre estas capas, especificando las tecnologías para la implementación de cada una y la comunicación entre ellas.

\subsubsection{Modelización de la arquitectura}

En el modelo de análisis desarrollado en la sección ~\ref{sec:secModeloAn} quedaron definidas un conjunto de clases de análisis (representadas en la figura ~\ref{fig:diagramaClasesAnalisis}). Con un nivel de abstracción relativamente alto, cada una describe algún elemento del dominio del problema y se centra en aspectos de éste visibles para el usuario.

En este punto, se reduce el nivel de abstracción y las clases de análisis se afinan hacía las clases de diseño, aportando los detalles que permitirán que las clases se implementen y generen una infraestructura para el software a desarrollar.

A la hora de realizar este refinamiento, se han de tener en cuenta una serie de características que aseguren que las clases de diseño quedan bien formadas \cite{Arl02}:

\begin{enumerate}
	\item \textit{Completa y suficiente}. Una clase de diseño debe encapsular todos los atributos y métodos que sea razonable esperar y que existan para la clase.
	\item \textit{Primitivismo}. Los métodos asociados con una clase de diseño deben centrarse en el cumplimiento de un servicio para la clase. Una vez implementado el servicio con un método, la
	clase no debe proveer otro modo de hacer lo mismo.
	\item \textit{Mucha cohesión}. Una clase de diseño cohesiva tiene un conjunto pequeño y centrado de	responsabilidades; para implementarlas emplea atributos y métodos de objetivo único.
	\item \textit{Poco acoplamiento}. Dentro del modelo de diseño, es necesario que las clases de diseño colaboren una con otra. Sin embargo, la colaboración debe mantenerse en un mínimo aceptable. Si un modelo de diseño está muy acoplado (todas las clases de diseño colaboran con todas las demás), el sistema es difícil de implementar, probar y mantener con el paso del tiempo. En general, las clases de diseño dentro de un subsistema deben tener sólo un conocimiento limitado de otras clases.
\end{enumerate}

Se ha de tener en cuenta que el sistema cuenta tanto con una capa de aplicación como con otra de servidor, con lo que se ha de modelizar la arquitectura de ambas capas.

Así, en la figura ~\ref{fig:diagramaClasesDisenoCliente} se aporta el diagrama de clases de diseño para la capa del cliente del futuro sistema, si bien cabe señalar que el objetivo del diagrama de clases de diseño es el de modelizar la arquitectura básica del sistema a implementar; con lo que, para mantener la vista de dicha arquitectura útil y clara, no se incluyen clases, atributos o métodos que tengan un carácter accesorio o no aporten de manera directa a la consecución de los requisitos descritos en secciones anteriores. 

De este modo, no se incluyen métodos ligados a inicializaciones de interfaces de usuario o atributos relativos a dichas interfaces, métodos básicos como los \textit{get()} y \textit{set()} o clases accesorias sin implicación directa en los casos de uso, entre otros.

Sobre el diagrama presentado, destaca el empleo de dos patrones de diseño:

\begin{enumerate}
	\item \textbf{Singleton}. Patrón creacional utilizado con el objetivo de asegurarse de que una clase se instancia una única vez. 
	
	Dada la naturaleza de la entidad \emph{Usuario} según la cual una ejecución únicamente puede contar con un usuario activo a la vez (con posibles modificaciones sobre su estado), se considera que este patrón ayuda a forzar dicho objetivo, eliminando posibles errores o fallos futuros.
	\item \textbf{Observer}. Patrón de comportamiento utilizado para implementar la actualización de un objeto (o varios) ante el cambio en el estado de otro.
	
	Dado que los datos se almacenan por unas entidades y se muestran por otras, es necesario que cada vez que se produzca una operación con el servidor y éste notifique con el resultado, las clases del cliente que provocaron dicha llamada se actualicen convenientemente mediante la modificación de su estado, mostrando un mensaje de error si aplica, etc. Con ello, dicho patrón se aplica sobre las clases que provocan llamadas directas al servidor y las que gestionan las mismas. La base del patrón es una interfaz a ser implementada por las clases a ser actualizadas y sobre la que se notificarán los cambios o respuestas del servidor por parte de las clases gestoras de las comunicaciones.
\end{enumerate} 

\begin{landscape}
	\begin{figure}
		\centering
		\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/05_ClasesDiseno_App}
		\caption{Diagrama de clases de diseño de la capa del cliente}
		\label{fig:diagramaClasesDisenoCliente}
	\end{figure}	
\end{landscape}

Por su parte, en la figura ~\ref{fig:diagramaClasesDisenoServidor} queda esquematizada la arquitectura del servidor.

\begin{figure} [!htb]
	\centering
	\resizebox{10cm}{!}{\includegraphics[width=\linewidth,height=\textheight,keepaspectratio]{Images/Diagramas/05_ClasesDiseno_Server}}
	\caption{Diagrama de clases de diseño de la capa del servidor}
	\label{fig:diagramaClasesDisenoServidor}
\end{figure}

En este caso, se identifica el patrón \emph{Facade}, un patrón estructural utilizado para simplificar las interfaces o comunicaciones entre subsistemas.

Dado que el servidor supone la capa intermedia entre el cliente y la base de datos, este patrón ayuda a facilitar la comunicación entre ellos. El patrón se implementará partiendo de un clase abstracta de la que heredan las \emph{fachadas} específicas de cada entidad, siendo estas especificaciones las que recibirán las llamadas remotas. Todas ellas contarán con los métodos CRUD básicos implementados en la fachada padre, que es la que finalmente realiza la conexión con la base de datos. Esta clase padre será la que implementará, a su vez, los métodos de control para todas las entidades, de modo que las fachadas hijas sólo se dedican a recibir llamadas y e invocar el método de la clase padre oportuno.

Por claridad en el esquema, en las fachadas hijas no se han incluido los métodos de comunicación básicos por tratarse de llamadas al método  CRUD  específico de la clase padre. Asimismo, en esta fachada padre se apuntan dichos métodos CRUD sin entrar en posibles adecuaciones a cada entidad, además de métodos operativos necesarios para la funcionalidad del sistema.

Se observa, a su vez, que la fachada padre ha de incluir dos mensajes estándar de respuesta para indicar si la operación ha ido bien o no, de modo que el cliente (que también conoce estos mensajes) reaccione de manera oportuna.


\subsection{Diseño de las interfaces}

Una vez establecida la arquitectura básica sobre la que se fundamentará el sistema, el segundo apartado a definir en el modelo de diseño son las interfaces de comunicación y de usuario. Estos elementos permiten que el software se comunique externamente y permita la comunicación y colaboración internas entre los componentes que constituyen la arquitectura del software.

\subsubsection{Interfaces de comunicación}

Dentro de la arquitectura Cliente/Servidor se hace necesario definir la comunicación entre ambas capas. Si bien los detalles técnicos para su implementación se comentan en la siguiente sección ~\ref{sec:secModeloImp}, en este punto se aporta una capa de diseño que suponga una introducción conceptual a las mismas. 

Como quedó definido en el apartado de requisitos, la comunicación Cliente/Servidor se ha de regir de acuerdo a la tecnología RESTful Web Services, que se comentará más adelante. Esta tecnología parte de comunicaciones HTTP, alcanzando los diferentes métodos remotos mediante URLs diferenciadas. Así, se hace necesario definir una URL estándar que sirva de base para todas las concretas de cada método a ejecutar en el servidor. Se considera la siguiente plantilla: $$http://[IP\_SERV]:[PORT]/BikesManager/rest/entities.[ENTITY]$$
donde $IP\_SERV$ indica la IP dirección del servidor, $PORT$ indica el puerto donde el servidor se encuentra escuchando y $ENTITY$ indica la entidad (Usuario, Estación o Reserva) que realiza la llamada remota.

A partir de esta URL general se formarán las específicas de la forma siguiente: $$[BASE\_URL]/[METHOD]$$
donde $BASE\_URL$ es la URL básica indicada más arriba y $METHOD$ indica el método o parámetros que se añaden en la dirección para la llamada del método que sea necesario.

Una vez un método se ejecuta en el servidor, éste devolverá la cadena resultante al cliente. En caso de que se tenga que indicar si la operación se ha realizado correctamente o no, se enviarán cadenas del estilo $[ENTITY]\_SERVER\_OK$ o $[ENTITY]\_SERVER\_KO$, respectivamente.

Las cadenas que se intercambian entre ambas capas seguirán el formato de texto JSON\footnote{Una introducción a este lenguaje se recoge en la web \url{http://www.json.org/json-es.html}}, la tecnología para la traducción de cadenas se comenta en la siguiente sección ~\ref{sec:secModeloImp}.

La selección de este formato en lugar del tradicional XML queda principalmente motivada por el hecho de que el primero es más sencillo a la hora compartir \emph{datos tradicionales} como texto o números, que son los utilizados por el sistema descrito, y no datos estructurados como podrían ser documentos, fotos, vídeos, etc.

Finalmente, comentar la utilización de los patrones \emph{Observer} y \emph{Facade} para mejorar y estandarizar la comunicación entre componentes ante las problemáticas específicas apuntadas anteriormente.




%urls, mensajes entre servidor y cliente: entityID, RESPONSE_OK y KO, web services y json (en la sección de implementación se dice: REST y SOAP, librería JACKSON, JSON vs XML, ...))

\subsubsection{Interfaces de usuario}

Diseño Android, fragments, reglas de oro, "aspectos de diseño"



% ------------------------------
% -- Modelo de implementación --
% ------------------------------

\section{Implementación}
\label{sec:secModeloImp}

Sin enrollarse mucho con detalles\dots Herramientas utilizadas\dots Un diagrama de despliegue a lo mejor\dots
Herramientas: NetBeans, Android Estudio, MySQL Workbecnh. Tecnologías: Android, GlassFish, SQL, JACKSON (vs otras) y RESTFul (vs SOAP) Comentar la versión Android utilizada y poner el pantallazo de la cobertura. Librerías de compatibilidad también.